{
    "name": "ë…¸ì…˜ ë§ˆê°ì¼ ë¦¬ë§ˆì¸ë” (ì´ë©”ì¼)",
    "nodes": [
        {
            "parameters": {
                "rule": {
                    "interval": [
                        {
                            "field": "cronExpression",
                            "expression": "0 9 * * *"
                        }
                    ]
                }
            },
            "id": "1c467417-a3ed-4d7f-a152-6877729e8a41",
            "name": "ë§¤ì¼ ì˜¤ì „ 9ì‹œ",
            "type": "n8n-nodes-base.scheduleTrigger",
            "typeVersion": 1.2,
            "position": [
                340,
                300
            ]
        },
        {
            "parameters": {
                "resource": "databasePage",
                "operation": "getAll",
                "databaseId": {
                    "__rl": true,
                    "value": "242003c7-f7be-804a-9d6e-f76d5d0347b4",
                    "mode": "list",
                    "cachedResultName": "Beyond_Tasks",
                    "cachedResultUrl": "https://www.notion.so/242003c7f7be804a9d6ef76d5d0347b4"
                },
                "returnAll": true,
                "filterType": "manual",
                "options": {}
            },
            "id": "2df9298c-8b6f-4cdf-b818-750d1321b761",
            "name": "ë…¸ì…˜ DB ì¡°íšŒ",
            "type": "n8n-nodes-base.notion",
            "typeVersion": 2.2,
            "position": [
                560,
                300
            ],
            "credentials": {
                "notionApi": {
                    "id": "xw5kbbLStDNvEvBq",
                    "name": "Notion account"
                }
            }
        },
        {
            "parameters": {
                "jsCode": "// ì˜¤ëŠ˜ ë‚ ì§œ (ì‹œê°„ ì œì™¸)\nconst today = new Date();\ntoday.setHours(0, 0, 0, 0);\n\nconst overdueItems = [];\n\nfor (const item of $input.all()) {\n  const data = item.json;\n  \n  // Completed ì²´í¬ë°•ìŠ¤ í™•ì¸\n  const isCompleted = data.property_completed === true;\n  \n  // ì´ë¯¸ ì™„ë£Œëœ í•­ëª©ì€ ìŠ¤í‚µ\n  if (isCompleted) continue;\n  \n  // ë‚ ì§œ í•„ë“œ í™•ì¸\n  const dueDateField = data.property_date;\n  \n  if (dueDateField && dueDateField.start) {\n    // ì¢…ë£Œì¼ì´ ìˆìœ¼ë©´ ì¢…ë£Œì¼ì„ ë§ˆê°ì¼ë¡œ ì‚¬ìš©, ì—†ìœ¼ë©´ ì‹œì‘ì¼ ì‚¬ìš©\n    const deadlineStr = dueDateField.end || dueDateField.start;\n    const deadline = new Date(deadlineStr);\n    deadline.setHours(0, 0, 0, 0);\n    \n    // ë§ˆê°ì¼ì´ ì˜¤ëŠ˜ ì´ì „ì¸ì§€ í™•ì¸ (ì˜¤ëŠ˜ë„ í¬í•¨í•˜ë ¤ë©´ <= ì‚¬ìš©)\n    if (deadline < today) {\n      const title = data.name || 'ì œëª© ì—†ìŒ';\n      const daysPast = Math.floor((today - deadline) / (1000 * 60 * 60 * 24));\n      \n      overdueItems.push({\n        title: title,\n        dueDate: deadlineStr,\n        daysPast: daysPast,\n        url: data.url,\n        status: data.property_status || ''\n      });\n    }\n  }\n}\n\nif (overdueItems.length === 0) {\n  return [];\n}\n\noverdueItems.sort((a, b) => b.daysPast - a.daysPast);\n\nlet htmlMessage = `<h2>â° ë§ˆê°ì¼ ì§€ë‚œ í• ì¼ ì•Œë¦¼</h2>`;\nhtmlMessage += `<p>ğŸ“‹ ì´ <strong>${overdueItems.length}ê°œ</strong> í•­ëª©ì´ ë§ˆê°ì¼ì„ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤.</p>`;\nhtmlMessage += `<table style=\"border-collapse: collapse; width: 100%;\">`;\nhtmlMessage += `<tr style=\"background: #f5f5f5;\"><th style=\"padding: 10px; border: 1px solid #ddd;\">í•­ëª©</th><th style=\"padding: 10px; border: 1px solid #ddd;\">ë§ˆê°ì¼</th><th style=\"padding: 10px; border: 1px solid #ddd;\">ì´ˆê³¼ì¼</th><th style=\"padding: 10px; border: 1px solid #ddd;\">ìƒíƒœ</th></tr>`;\n\noverdueItems.forEach((item) => {\n  htmlMessage += `<tr>`;\n  htmlMessage += `<td style=\"padding: 10px; border: 1px solid #ddd;\"><a href=\"${item.url}\">${item.title}</a></td>`;\n  htmlMessage += `<td style=\"padding: 10px; border: 1px solid #ddd;\">${item.dueDate}</td>`;\n  htmlMessage += `<td style=\"padding: 10px; border: 1px solid #ddd; color: red;\">âš ï¸ ${item.daysPast}ì¼</td>`;\n  htmlMessage += `<td style=\"padding: 10px; border: 1px solid #ddd;\">${item.status}</td>`;\n  htmlMessage += `</tr>`;\n});\n\nhtmlMessage += `</table>`;\nhtmlMessage += `<p style=\"color: #888; margin-top: 20px;\">ğŸ“† í™•ì¸ ì‹œê°„: ${new Date().toLocaleString('ko-KR', { timeZone: 'Asia/Seoul' })}</p>`;\n\nreturn [{ \n  json: { \n    subject: `â° ë§ˆê° ì´ˆê³¼ ì•Œë¦¼: ${overdueItems.length}ê°œ í•­ëª©`,\n    htmlMessage: htmlMessage,\n    count: overdueItems.length, \n    items: overdueItems \n  } \n}];"
            },
            "id": "02786d0e-7f22-4423-a3dd-dab2afb75f78",
            "name": "ë§ˆê°ì¼ ì²´í¬ ë° ë©”ì‹œì§€ ìƒì„±",
            "type": "n8n-nodes-base.code",
            "typeVersion": 2,
            "position": [
                780,
                300
            ]
        },
        {
            "parameters": {
                "sendTo": "beyondworks.br@gmail.com",
                "subject": "={{ $json.subject }}",
                "emailType": "html",
                "message": "={{ $json.htmlMessage }}",
                "options": {}
            },
            "id": "gmail-send-node-001",
            "name": "Gmail ì´ë©”ì¼ ë°œì†¡",
            "type": "n8n-nodes-base.gmail",
            "typeVersion": 2.1,
            "position": [
                1000,
                300
            ],
            "credentials": {
                "gmailOAuth2": {
                    "id": "W7t4afVVAIjdOHwo",
                    "name": "Gmail account"
                }
            }
        }
    ],
    "connections": {
        "ë§¤ì¼ ì˜¤ì „ 9ì‹œ": {
            "main": [
                [
                    {
                        "node": "ë…¸ì…˜ DB ì¡°íšŒ",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "ë…¸ì…˜ DB ì¡°íšŒ": {
            "main": [
                [
                    {
                        "node": "ë§ˆê°ì¼ ì²´í¬ ë° ë©”ì‹œì§€ ìƒì„±",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        },
        "ë§ˆê°ì¼ ì²´í¬ ë° ë©”ì‹œì§€ ìƒì„±": {
            "main": [
                [
                    {
                        "node": "Gmail ì´ë©”ì¼ ë°œì†¡",
                        "type": "main",
                        "index": 0
                    }
                ]
            ]
        }
    },
    "settings": {
        "executionOrder": "v1"
    }
}